#summary WIP details for getting Qt Embedded up and running under COGlinux.

= Introduction =

*!!!!WORK - IN - PROGRESS!!!!*

_*!!Use at your own risk!!*_


= Details =

== Ubuntu Setup ==

Packages
  * build-essential
  * autoconf
  * automake
  * texinfo
  * libtool
  * libusb-dev
  * SVN(Subversion) & CVS
  * RPM & alien

{{{
cd ~
mkdir dev
cd dev
mkdir libs
mkdir drivers
sudo apt-get install build-essential autoconf automake texinfo libtool libusb-dev subversion cvs rpm alien
}}}

== GNU ARM Toolchain ==

Sourcery G++ Lite 2008q1-126 for ARM GNU/Linux (http://www.codesourcery.com/gnu_toolchains/arm)

{{{
cd ~/Desktop
chmod 755 arm-2008q1-126-arm-none-linux-gnueabi.bin
./arm-2008q1-126-arm-none-linux-gnueabi.bin
cd ~/CodeSourcery/Sourcery_G++_Lite/bin
export PATH=${PWD}:${PATH}
}}}

== Libraries ==

  * CP210x USB to UART Bridge VCP Drivers (http://www.silabs.com/tgwWebApp/public/web_content/products/Microcontrollers/USB/en/mcu_vcp.htm)

{{{
cd ~/dev/drivers
gzip -cd cp210x-3.0.0.tar.gz | tar xvf -
cd cp210x-3.0.0
./makerpm
cd /var/tmp/silabs/rpmbuild/RPMS/i386
sudo alien -iv cp210x-3.0.0-001.i386.rpm
(plug USB cable into VCMX212 *THEN* into PC)
dmesg | grep USB (to check to see if the install has worked)
sudo apt-get install minicom
sudo minicom -s
minicom
}}}

  * FTDI FT2232 (http://www.intra2net.com/de/produkte/opensource/ftdi/)

{{{
cd ~/dev/libs
gzip -cd libftdi-0.13.tar.gz | tar xvf -
cd libftdi-0.13
./configure
make
sudo make install
}}}

  * Tslib (See section below 'Touch Screen Driver')

== OpenOCD ==

http://openfacts.berlios.de/index-en.phtml?title=Open_On-Chip_Debugger
http://buffalo.nas-central.org/index.php/JTAG_&_OpenOCD_for_LS-Pro
http://forum.sparkfun.com/viewtopic.php?p=47245&highlight=#47245

  * TODO: Does the USB codes match the existing OpenOCD VC config file?
          Yes, but ft2232_device_desc needed to change to "Olimex OpenOCD JTAG TINY"
  * TODO: GDB Server??
          Comes with Codesourcery??

{{{
cd ~/dev/drivers
svn co svn://svn.berlios.de/openocd/trunk openocd
cd openocd
./bootstrap
./configure --enable-ft2232_libftdi
make
sudo make install
Add "none /proc/bus/usb usbfs auto,users,devmode=0666 0 0" to /etc/fstab
cd ~/dev
openocd -f vcmx212.cfg &
}}}
Use lsusb to check that the dongle is connected, eg. for my Olimex ARM-USB-OCD there is the line "Bus 002 Device 003: ID 15ba:0004" (For others it could be "15ba:0003")..
{{{
cat /sys/bus/usb/devices/2-2/idProduct should equal "0004"
cat /sys/bus/usb/devices/2-2/idVendor should equal "15ba"
cat /sys/bus/usb/devices/2-2/manufacturer should equal "Olimex"
cat /sys/bus/usb/devices/2-2/product should equal "Olimex OpenOCD JTAG TINY"
}}}

== Eclipse ==

Qt integration (http://trolltech.com/developer/downloads/qt/eclipse-integration-download)

  * TODO: OpenOCD/GDB integration

  # Follow the instructions for installing Eclipse and JRE from https://help.ubuntu.com/community/EclipseIDE
  # Continue with Virtual Cogs Wiki installation steps from http://wiki.virtualcogs.com/index.php?title=Eclipse_IDE_setup_with_Virtual_Cogs

== Touch Screen Driver ==

http://www.jespersaur.com/drupal/node/30

http://groups.google.co.uk/group/virtualcogs/browse_thread/thread/58528d8bf9f84e8d/51bffac0f45c68cb?lnk=gst&q=tslib#51bffac0f45c68cb

http://groups.google.co.uk/group/virtualcogs/browse_thread/thread/a45cbad09f73c852/4cc767cd11663d12?lnk=gst&q=DirectFB#4cc767cd11663d12
  * TODO: Sort out shared libraries setup in COGlinux

  # Make the shared library and tools
  {{{
  cd ~/dev/libs
  svn co svn://svn.berlios.de/tslib/trunk/tslib tslib
  cd tslib
  ./autogen.sh
  ./configure --host=arm-none-linux-gnueabi --prefix=/mnt/sd???
  gedit config.h (to remove the '#define malloc rpl_malloc' line near end of file)
  make
  make install
  gedit /mnt/sd/etc/ts.conf (to uncomment the '# module_raw input' line)
  cp ~/dev/tsc2100.ko /mnt/sd (copy over to SD card the touchscreen kernel module)
  }}}
  # Transfer to COGlinux file system
  # Test the tools, e.g. ts_calibrate
  # Copy over and soft-link missing shared libraries (libc, libdl, etc)

== Qt Install ==

Qt Open Source Edition for C++ Developers: Embedded Linux Download (http://trolltech.com/downloads/opensource)

  * TODO: Create new mkspec for gnueabi-linux-arm-g++
  * TODO: Sort out ./configure options
{{{
cd ~/dev/QtE
gzip -cd qt-embedded-linux-opensource-src-4.4.0.tar.gz | tar xvf -
cd qt-embedded-linux-opensource-src-4.4.0
export QTEDIR=$PWD
./configure \
  -prefix /mnt/sd \
  -no-largefile -no-qvfb -no-svg -no-webkit \
  -qt-zlib -qt-gif -qt-libtiff -qt-libpng -qt-libmng -qt-libjpeg \
  -nomake demos \
  -pch \
  -xplatform qws/gnueabi-linux-arm-g++ \
  -embedded arm \
  -qconfig medium \
  -qt-mouse-tslib \
  -no-qt3support \
  -L/mnt/sd/lib/ -I/mnt/usb/include/
make
make install
}}}